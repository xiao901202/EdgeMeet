<?xml version="1.0" encoding="utf-8"?>
<Window x:ConnectionId='1'
    x:Class="ConferenceAssistant.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:ConferenceAssistant"
    xmlns:controls="using:ConferenceAssistant.Controls"
    xmlns:viewmodels="using:ConferenceAssistant.ViewModels"
    xmlns:converters="using:ConferenceAssistant.Converters"
    xmlns:models="using:ConferenceAssistant.Models"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Title="會議小助手 - Conference Assistant">


    <Window.SystemBackdrop>
        <MicaBackdrop />
    </Window.SystemBackdrop>


    <Grid>
        <Grid.Resources>
            <converters:WaveformHeightConverter x:Key="WaveformHeightConverter" />
            <converters:WaveformTopConverter x:Key="WaveformTopConverter" />
            <converters:IndexToLeftConverter x:Key="IndexToLeftConverter" />
            <converters:PlaybackPositionToLeftConverter x:Key="PlaybackPositionToLeftConverter" />
        </Grid.Resources>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- 標題列 -->
        <Border Grid.Row="0" Background="{ThemeResource LayerFillColorDefaultBrush}" Padding="16,12">
            <StackPanel Orientation="Horizontal" Spacing="12">
                <FontIcon Glyph="&#xE720;" FontSize="28" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                <TextBlock Text="會議小助手" 
                          Style="{ThemeResource TitleTextBlockStyle}"
                          FontFamily="Microsoft JhengHei UI"
                          VerticalAlignment="Center"/>
                <TextBlock Text="針對 Snapdragon X Elite 最佳化" 
                          Style="{ThemeResource CaptionTextBlockStyle}"
                          FontFamily="Microsoft JhengHei UI"
                          Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                          VerticalAlignment="Center"/>
            </StackPanel>
        </Border>

        <!-- 主要內容區域 -->
        <Grid x:ConnectionId='2' x:Name="MainContentGrid" Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="300"/>
                <ColumnDefinition Width="4"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- 左側會議記錄列表 -->
            <Border Grid.Column="0" 
                    Background="{ThemeResource LayerFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="0,0,1,0">
                <StackPanel>
                    <!-- 新增錄音按鈕 -->
                    <Border Padding="16,16,16,8">
                        <Button x:ConnectionId='42' x:Name="NewRecordingButton"
                               Content="+ 新增錄音"
                               Style="{StaticResource ActionButtonStyle}"
                               Background="{ThemeResource AccentButtonBackground}"
                               Foreground="{ThemeResource AccentButtonForeground}"
                               HorizontalAlignment="Stretch"
                                                               />
                    </Border>

                    <!-- 會議記錄列表 -->
                    <ScrollViewer Padding="8,0,8,16" VerticalScrollBarVisibility="Auto">
                        <ListView x:ConnectionId='35' x:Name="ConferenceRecordsList"
                                                                                                
                                                                                              
                                 SelectionMode="Single">
                            <ListView.ItemTemplate>
                                <DataTemplate                                         >
                                    <Border x:ConnectionId='37' Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                           BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                           BorderThickness="1"
                                           CornerRadius="6"
                                           Padding="12"
                                           Margin="4,2">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>

                                            <StackPanel Grid.Column="0" Spacing="4">
                                                <TextBlock x:ConnectionId='39'                       
                                                          FontWeight="SemiBold"
                                                          FontFamily="Microsoft JhengHei UI"
                                                          TextTrimming="CharacterEllipsis"
                                                          MaxLines="1"/>
                                                <TextBlock x:ConnectionId='40'                             
                                                          Style="{ThemeResource CaptionTextBlockStyle}"
                                                          FontFamily="Microsoft JhengHei UI"
                                                          Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                <TextBlock x:ConnectionId='41'                                 
                                                          Style="{ThemeResource CaptionTextBlockStyle}"
                                                          FontFamily="Microsoft JhengHei UI"
                                                          Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                                            </StackPanel>

                                            <!-- 重新命名按鈕 -->
                                            <Button x:ConnectionId='38' Grid.Column="1"
                                                   Width="44" Height="44"
                                                   Background="Transparent"
                                                   BorderThickness="0"
                                                   CornerRadius="22"
                                                   VerticalAlignment="Top"
                                                                                   
                                                                 
                                                   ToolTipService.ToolTip="重新命名">
                                                <FontIcon Glyph="&#xE70F;" FontSize="20"/>
                                            </Button>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>
                    </ScrollViewer>
                </StackPanel>
            </Border>

            <!-- 分隔線 -->
            <Border Grid.Column="1" Background="{ThemeResource DividerStrokeColorDefaultBrush}"/>

            <!-- 右側主內容區域 - 固定不滾動的容器 -->
            <Grid Grid.Column="2">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- 錄音/播放控制區域 - 固定在頂部 -->
                <Border Grid.Row="0" Style="{StaticResource CardStyle}" Margin="16,16,16,8">
                    <StackPanel Spacing="16">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE720;" FontSize="20" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                            <TextBlock x:ConnectionId='34' x:Name="ControlTitleText" Text="錄音控制" 
                                      Style="{ThemeResource SubtitleTextBlockStyle}"
                                      FontFamily="Microsoft JhengHei UI"/>
                        </StackPanel>

                        <!-- 錄音狀態或播放控制 -->
                        <StackPanel x:ConnectionId='15' x:Name="RecordingControlPanel" Spacing="16">
                            <!-- 音訊設備設定 -->
                            <StackPanel Spacing="12">
                                <TextBlock Text="音訊設定" 
                                          Style="{ThemeResource BodyStrongTextBlockStyle}"
                                          FontFamily="Microsoft JhengHei UI"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="16"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <!-- 音訊輸入設備 -->
                                    <StackPanel Grid.Column="0" Spacing="4">
                                        <TextBlock Text="麥克風" 
                                                  Style="{ThemeResource CaptionTextBlockStyle}"
                                                  FontFamily="Microsoft JhengHei UI"/>
                                        <ComboBox x:ConnectionId='33' x:Name="InputDeviceComboBox" 
                                                                                                    
                                                                                                             
                                          HorizontalAlignment="Stretch"
                                          FontFamily="Microsoft JhengHei UI"
                                          PlaceholderText="選擇麥克風" />
                                    </StackPanel>

                                    <StackPanel Grid.Column="2" Spacing="4">
                                        <TextBlock Text="喇叭" 
                                           Style="{ThemeResource CaptionTextBlockStyle}"
                                           FontFamily="Microsoft JhengHei UI"/>
                                        <ComboBox x:ConnectionId='32' x:Name="OutputDeviceComboBox"
                                                                                                     
                                                                                                                   
                                          HorizontalAlignment="Stretch"
                                          FontFamily="Microsoft JhengHei UI"
                                          PlaceholderText="選擇喇叭"/>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>

                            <!-- 錄音狀態顯示 -->
                            <controls:RecordingStatusControl x:ConnectionId='27' x:Name="RecordingStatus"/>

                            <!-- 錄音時間顯示 -->
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <FontIcon Glyph="&#xE916;" FontSize="20" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                                <TextBlock Text="錄音時間:" 
                                          Style="{ThemeResource BodyTextBlockStyle}"
                                          FontFamily="Microsoft JhengHei UI"/>
                                <TextBlock x:ConnectionId='31' x:Name="RecordingTimeText" Text="00:00:00" 
                                          Style="{ThemeResource BodyTextBlockStyle}"
                                          FontFamily="Microsoft JhengHei UI"
                                          FontWeight="SemiBold"
                                          Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                            </StackPanel>

                            <!-- 錄音控制按鈕 -->
                            <Grid>
                                <StackPanel Orientation="Horizontal" Spacing="24" HorizontalAlignment="Center">
                                    <!-- 開始錄音按鈕 (改為紅色) -->
                                    <Button x:ConnectionId='28' x:Name="StartRecordingButton"
                                           Width="80" Height="80"
                                           CornerRadius="40"
                                           Background="#DC143C"
                                           BorderThickness="0"
                                                                             
                                           ToolTipService.ToolTip="開始錄音">
                                        <FontIcon Glyph="&#xE720;" FontSize="32" Foreground="White"/>
                                    </Button>

                                    <!-- 停止錄音按鈕 -->
                                    <Button x:ConnectionId='29' x:Name="StopRecordingButton"
                                           Width="80" Height="80"
                                           CornerRadius="40"
                                           Background="{ThemeResource SystemFillColorNeutralBrush}"
                                           BorderThickness="0"
                                                                            
                                           ToolTipService.ToolTip="停止錄音">
                                        <FontIcon Glyph="&#xE15B;" FontSize="32" Foreground="White"/>
                                    </Button>

                                    <!-- 上傳音訊按鈕 -->
                                    <Button x:ConnectionId='30' x:Name="UploadAudioButton"
                                           Width="80" Height="80"
                                           CornerRadius="40"
                                           Background="{ThemeResource SystemFillColorAttentionBrush}"
                                           BorderThickness="0"
                                                                          
                                           ToolTipService.ToolTip="上傳音訊檔案">
                                        <FontIcon Glyph="&#xE8E5;" FontSize="32" Foreground="White"/>
                                    </Button>
                                </StackPanel>
                            </Grid>
                        </StackPanel>

                        <!-- 播放控制面板 -->
                        <StackPanel x:ConnectionId='16' x:Name="PlaybackControlPanel" Spacing="16">
                            <!-- AI語音轉錄按鈕 (靠左對齊) -->
                            <Button x:ConnectionId='18' x:Name="TranscribeButton"
                                   Width="200" Height="50"
                                   Background="{ThemeResource AccentButtonBackground}"
                                   Foreground="{ThemeResource AccentButtonForeground}"
                                   CornerRadius="8"
                                                                 
                                   Visibility="Collapsed"
                                   HorizontalAlignment="Left">
                                <StackPanel Orientation="Horizontal" Spacing="12">
                                    <FontIcon Glyph="&#xE8B9;" FontSize="22"/>
                                    <TextBlock Text="AI語音轉錄" FontWeight="SemiBold" FontSize="16"/>
                                </StackPanel>
                            </Button>

                            <!--  取代你的模擬波形區塊 -->
                            <Border Height="120" 
        Background="{ThemeResource SubtleFillColorSecondaryBrush}"
        CornerRadius="8"
        Padding="0">
                                <ScrollViewer HorizontalScrollMode="Enabled"
              HorizontalScrollBarVisibility="Hidden"
              VerticalScrollMode="Disabled"
              ZoomMode="Disabled"
              Height="120">
                                    <Canvas Height="120"
            Width="{Binding WaveformCanvasWidth}">
                                        <ItemsControl ItemsSource="{Binding WaveformSamples}">
                                            <ItemsControl.ItemsPanel>
                                                <ItemsPanelTemplate>
                                                    <Canvas />
                                                </ItemsPanelTemplate>
                                            </ItemsControl.ItemsPanel>
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate>
                                                    <Rectangle Width="2"
                               Fill="{ThemeResource AccentFillColorDefaultBrush}"
                               Height="{Binding Value, Converter={StaticResource WaveformHeightConverter}}"
                               Canvas.Left="{Binding Index, Converter={StaticResource IndexToLeftConverter}}"
                               Canvas.Top="{Binding Value, Converter={StaticResource WaveformTopConverter}}" />
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>

                                        <!-- 播放位置指示器 -->
                                        <Rectangle Width="2" Height="120"
                   Fill="{ThemeResource SystemAccentColor}"
                   Canvas.Left="{Binding PlaybackPosition, Converter={StaticResource PlaybackPositionToLeftConverter}}" />
                                    </Canvas>
                                </ScrollViewer>
                            </Border>


                            <!-- 播放進度條 -->
                            <Slider x:ConnectionId='19' x:Name="PlaybackSlider"
                                                                                        
                                                                                       
                                                              
                                                                          
                                                                              
                                                                                />

                            <!-- 播放控制按鈕和時間顯示 -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <!-- 播放控制按鈕 -->
                                <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="16">
                                    <Button x:ConnectionId='22' x:Name="PlayPauseButton"
                                           Width="64" Height="64"
                                           Background="{ThemeResource AccentButtonBackground}"
                                           Foreground="{ThemeResource AccentButtonForeground}"
                                           CornerRadius="32"
                                           BorderThickness="0"
                                                                        
                                           ToolTipService.ToolTip="播放/暫停">
                                        <FontIcon x:ConnectionId='25' x:Name="PlayPauseIcon" Glyph="&#xE102;" FontSize="24"/>
                                    </Button>

                                    <Button x:ConnectionId='23' Width="56" Height="56" 
                                           CornerRadius="28"
                                           Background="{ThemeResource ControlFillColorDefaultBrush}"
                                           BorderThickness="0"
                                                                     
                                           ToolTipService.ToolTip="快退10秒">
                                        <FontIcon Glyph="&#xE100;" FontSize="20"/>
                                    </Button>

                                    <Button x:ConnectionId='24' Width="56" Height="56" 
                                           CornerRadius="28"
                                           Background="{ThemeResource ControlFillColorDefaultBrush}"
                                           BorderThickness="0"
                                                                    
                                           ToolTipService.ToolTip="快進10秒">
                                        <FontIcon Glyph="&#xE101;" FontSize="20"/>
                                    </Button>
                                </StackPanel>

                                <!-- 時間顯示 -->
                                <StackPanel Grid.Column="2" Orientation="Horizontal" Spacing="8" VerticalAlignment="Center">
                                    <TextBlock x:ConnectionId='20'                                                    
                                              Style="{ThemeResource BodyTextBlockStyle}"/>
                                    <TextBlock Text="/" 
                                              Style="{ThemeResource BodyTextBlockStyle}"
                                              Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                    <TextBlock x:ConnectionId='21'                                                  
                                              Style="{ThemeResource BodyTextBlockStyle}"
                                              Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                </StackPanel>
                            </Grid>
                        </StackPanel>

                        <!-- 處理狀態指示器 -->
                        <StackPanel x:ConnectionId='17' x:Name="ProcessingIndicator" Orientation="Horizontal" Spacing="8" Visibility="Collapsed">
                            <ProgressRing IsActive="True" Width="20" Height="20"/>
                            <TextBlock Text="正在處理..." VerticalAlignment="Center"/>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- 轉錄和摘要區域 - 可滾動 -->
                <ScrollViewer Grid.Row="1" Padding="16,0,16,16" VerticalScrollBarVisibility="Auto">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="8"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- 轉錄內容 -->
                        <Border Grid.Column="0" Style="{StaticResource CardStyle}">
                            <StackPanel Spacing="12">
                                <Grid>
                                    <StackPanel Orientation="Horizontal" Spacing="6" VerticalAlignment="Center">
                                        <FontIcon Glyph="&#xE8BD;" FontSize="20" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}" VerticalAlignment="Center"/>
                                        <TextBlock Text="轉錄內容" Style="{ThemeResource SubtitleTextBlockStyle}" VerticalAlignment="Center"/>
                                    </StackPanel>
                                    <Button x:ConnectionId='14' x:Name="ExportTranscriptButton" 
                                           HorizontalAlignment="Right" 
                                           VerticalAlignment="Top"
                                           Width="48" Height="48"
                                           Background="Transparent"
                                           BorderThickness="0"
                                           CornerRadius="24"
                                           ToolTipService.ToolTip="匯出轉錄內容"
                                                                               >
                                        <FontIcon Glyph="&#xE74E;" FontSize="22"/>
                                    </Button>
                                </Grid>

                                <!-- 轉錄段落列表 -->
                                <ScrollViewer Height="400" VerticalScrollBarVisibility="Auto">
                                    <ListView x:ConnectionId='8' x:Name="TranscriptSegmentsList"
                                                                                                                    >
                                        <ListView.ItemTemplate>
                                            <DataTemplate                                          >
                                                <Border x:ConnectionId='10' Background="{ThemeResource SubtleFillColorSecondaryBrush}"
                                                       Padding="12" Margin="0,4" CornerRadius="4">
                                                    <StackPanel Spacing="4">
                                                        <Grid>
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="Auto"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                                <ColumnDefinition Width="*"/>
                                                            </Grid.ColumnDefinitions>

                                                            <!-- 時間戳 -->
                                                            <HyperlinkButton x:ConnectionId='12' Grid.Column="0"
                                                                                                               
                                                                                                        
                                                                                                   
                                                                           Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"
                                                                           FontFamily="Microsoft JhengHei UI"
                                                                           FontWeight="SemiBold"
                                                                           VerticalAlignment="Top"
                                                                           Padding="0"
                                                                           Margin="0,0,12,0"/>

                                                            <!-- 參與者 -->
                                                            <TextBlock x:ConnectionId='13' Grid.Column="1"
                                                                                              
                                                                      FontWeight="SemiBold" 
                                                                      FontFamily="Microsoft JhengHei UI"
                                                                      Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"
                                                                      VerticalAlignment="Top"
                                                                      Margin="0,0,12,0"/>
                                                        </Grid>

                                                        <!-- 轉錄文字 -->
                                                        <TextBlock x:ConnectionId='11'                      
                                                                  TextWrapping="Wrap"
                                                                  FontFamily="Microsoft JhengHei UI"
                                                                  IsTextSelectionEnabled="True"
                                                                  Margin="0,4,0,0"/>
                                                    </StackPanel>
                                                </Border>
                                            </DataTemplate>
                                        </ListView.ItemTemplate>
                                    </ListView>
                                </ScrollViewer>
                            </StackPanel>
                        </Border>

                        <!-- 智能摘要 -->
                        <Border Grid.Column="2" Style="{StaticResource CardStyle}">
                            <StackPanel Spacing="12">
                                <Grid>
                                    <StackPanel Orientation="Horizontal" Spacing="6" VerticalAlignment="Center">
                                        <FontIcon Glyph="&#xE8AC;" FontSize="20" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}" VerticalAlignment="Center"/>
                                        <TextBlock Text="智能摘要" Style="{ThemeResource SubtitleTextBlockStyle}" VerticalAlignment="Center"/>
                                    </StackPanel>
                                    <Button x:ConnectionId='7' x:Name="ExportSummaryButton" 
                                           HorizontalAlignment="Right" 
                                           VerticalAlignment="Top"
                                           Width="48" Height="48"
                                           Background="Transparent"
                                           BorderThickness="0"
                                           CornerRadius="24"
                                           ToolTipService.ToolTip="匯出摘要內容"
                                                                            >
                                        <FontIcon Glyph="&#xE74E;" FontSize="22"/>
                                    </Button>
                                </Grid>

                                <!-- 摘要內容 -->
                                <ScrollViewer Height="400" VerticalScrollBarVisibility="Auto">
                                    <TextBlock x:ConnectionId='6' x:Name="SummaryText"
                                                                                            
                                              TextWrapping="Wrap"
                                              FontFamily="Microsoft JhengHei UI"
                                              Style="{ThemeResource BodyTextBlockStyle}"
                                              IsTextSelectionEnabled="True"/>
                                </ScrollViewer>
                            </StackPanel>
                        </Border>
                    </Grid>
                </ScrollViewer>
            </Grid>
        </Grid>

        <!-- 小窗格錄音界面 -->
        <Grid x:ConnectionId='3' x:Name="CompactRecordingPanel" 
              Grid.RowSpan="2"
              Background="{ThemeResource AcrylicBackgroundFillColorDefaultBrush}"
              Visibility="Collapsed">
            <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="16"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    MaxWidth="380"
                    Height="120">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- 錄音指示器 -->
                    <Ellipse Grid.Column="0" 
                             Width="12" Height="12" 
                             Fill="Red" 
                             VerticalAlignment="Center"
                             Margin="0,0,12,0">
                        <Ellipse.OpacityTransition>
                            <ScalarTransition Duration="0:0:1"/>
                        </Ellipse.OpacityTransition>
                    </Ellipse>

                    <!-- 錄音時間 -->
                    <TextBlock x:ConnectionId='4' x:Name="CompactRecordingTimeText" 
                               Grid.Column="1"
                               Text="00:00:00" 
                               Style="{ThemeResource SubtitleTextBlockStyle}" 
                               FontFamily="Microsoft JhengHei UI"
                               VerticalAlignment="Center"
                               FontWeight="SemiBold"
                               Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>

                    <!-- 暫停按鈕 -->
                    <Button Grid.Column="2"
                            Width="32" Height="32"
                            CornerRadius="16"
                            Background="{ThemeResource SystemFillColorAttentionBrush}"
                            Margin="8,0"
                            ToolTipService.ToolTip="暫停">
                        <FontIcon Glyph="&#xE103;" FontSize="12" Foreground="White"/>
                    </Button>

                    <!-- 停止按鈕 -->
                    <Button x:ConnectionId='5' x:Name="CompactStopButton" 
                            Grid.Column="3"
                            Width="32" Height="32"
                            CornerRadius="16"
                            Background="{ThemeResource SystemFillColorCriticalBrush}"
                                                             
                            ToolTipService.ToolTip="停止錄音">
                        <FontIcon Glyph="&#xE15B;" FontSize="12" Foreground="White"/>
                    </Button>
                </Grid>
            </Border>
        </Grid>
    </Grid>
</Window>


